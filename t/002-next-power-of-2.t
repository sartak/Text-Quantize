#!/usr/bin/env perl
use strict;
use warnings;
use Test::More;
use Text::Quantize;

my @data = (
    0 => 0,

    1  => 2,
    2  => 4,
    3  => 4,
    4  => 8,
    5  => 8,
    6  => 8,
    7  => 8,
    8  => 16,
    9  => 16,
    10 => 16,
    11 => 16,
    12 => 16,
    13 => 16,
    14 => 16,
    15 => 16,
    16 => 32,
    17 => 32,
    18 => 32,
    19 => 32,
    20 => 32,

    31 => 32,
    32 => 64,
    33 => 64,

    63 => 64,
    64 => 128,
    65 => 128,


    -1  => -2,
    -2  => -4,
    -3  => -4,
    -4  => -8,
    -5  => -8,
    -6  => -8,
    -7  => -8,
    -8  => -16,
    -9  => -16,
    -10 => -16,
    -11 => -16,
    -12 => -16,
    -13 => -16,
    -14 => -16,
    -15 => -16,
    -16 => -32,
    -17 => -32,
    -18 => -32,
    -19 => -32,
    -20 => -32,

    -31 => -32,
    -32 => -64,
    -33 => -64,

    -63 => -64,
    -64 => -128,
    -65 => -128,
);

plan tests => @data/2;
while (my ($input, $expected) = splice(@data, 0, 2)) {
    my $output = Text::Quantize::_next_power_of_2($input);
    is($output, $expected, "_next_power_of_2($input)");
}

